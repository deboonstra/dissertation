---
title: "Simulations investigating the correlation structure selection properties for $\\delta_{0}$"
subtitle: "given $\\alpha = 0.70$ and dim($\\boldsymbol{\\beta}$) = 3"
author: "D. Erik Boonstra, MS"
output:
  html_document:
    toc: TRUE
    toc_depth: 2
    toc_float: TRUE
---

```{r, include = FALSE, results = FALSE, message = FALSE}
R <- list.files(path = "./R", pattern = "*.R", full.names = TRUE)
sapply(R, source, .GlobalEnv)
knitr::opts_chunk$set(
  echo = FALSE,
  out.width = "100%",
  fig.align = "center",
  warning = FALSE
)
```

# Purpose of simulations
The results of these simulations are to investigate the correlation structure selection properties of the oracle forms of a new measure called $\delta$. The name of this measure might evolve if the results are promising.

# Definition of $\delta$
Given two square matrices, $\mathbf{A}$ and $\mathbf{B}$, of the same dimension, $d$, let $\delta$ be define as the following:
$$
\delta(\mathbf{A}, \mathbf{B}) = \sum_{i = 1}^{d} max\left(\frac{b_{ii}}{a_{ii}}, \frac{a_{ii}}{b_{ii}}\right),
$$

where $a_{ii}$ and $b_{ii}$ are the diagonal elements of the matrices $\mathbf{A}$ and $\mathbf{B}$. The minimum value for $\delta$ will be the dimension of the matrices $d$. This minimum will be achieved if $a_{ii} \approx b_{ii}$ for all $i$. By the definition of $\delta$, this measure is a symmetric discrepancy.

## $\delta$ for GEEs
Let $R(\alpha) = R$ be the working correlation structure and $\hat{\boldsymbol{\beta}}(R)$ be mean parameter estimator given $R$. Furthermore, let the model-based estimated covariance matrix of $\hat{\boldsymbol{\beta}}$ be $\hat{\boldsymbol{\Sigma}}$ and the robust or sandwich estimated covariance matrix of $\hat{\boldsymbol{\beta}}$ be $\hat{\mathbf{V}}_{r}$. Then, in the generalized estimating equations (GEEs) setting, we hope $\delta$ will be able to select the proper correlation structure by comparing the model-based covariance matrix, $\hat{\boldsymbol{\Sigma}}$, given $\hat{\boldsymbol{\beta}}(R)$ to the robust covariance matrix, $\hat{\mathbf{V}}_{r}$, given $\hat{\boldsymbol{\beta}}(R)$. 

$$
\delta = \delta\left(\hat{\boldsymbol{\Sigma}}, \hat{\mathbf{V}}_{r}\right)
$$

The robust covariance matrix $\hat{\mathbf{V}}_{r}$ protects against misspecification of the working correlation structure while the variance estimates for the model-based covariance matrix $\hat{\boldsymbol{\Sigma}}$ could vary drastically based on the working correlation structure. If $\delta \approx k$, where $k$ is the dimension of the parameter vector $\boldsymbol{\beta}$, then one would be able to assume that $\boldsymbol{\Sigma} \approx \mathbf{V}_{r}$ and the working correlation structure is appropriate given the mean structure is specified properly. The use of $\delta$ in the GEEs setting is reasonable because the mean structure estimates are protected against misspecification of the correlation structure and proper selection of correlation structure provides gains in efficiency not accuracy of statistical inference.

## Forms of $\delta_0$
The oracle of $\delta$, $\delta_{0}$, may take two forms based on the covariance estimator used in coordination with the simulated true covariance matrix, $\boldsymbol{\Sigma}$, of $\hat{\boldsymbol{\beta}}$ given the true correlation structure. For the true correlation structure, the true covariance matrix, $\boldsymbol{\Sigma}$ can be approximated by running a large number of simulations, $D$, pulling out the $\hat{\boldsymbol{\Sigma}}$, the estimated model-based covariance matrix, for each simulation and averaging across the estimated covariance matrices.

$$
\boldsymbol{\Sigma} = \frac{1}{D}\sum_{\ell = 1}^{D}\hat{\boldsymbol{\Sigma}}_{\ell}
$$

Then, $\delta_{0}$ may be either $\delta_{0} = \delta\left(\hat{\boldsymbol{\Sigma}}, \boldsymbol{\Sigma}\right)$ or $\delta_{0} = \delta\left(\hat{\mathbf{V}}_{r}, \boldsymbol{\Sigma}\right)$, where $\hat{\mathbf{V}}_{r}$ is the estimated robust covariance matrix. These two forms of $\delta_{0}$ provide insight into the bias and variability of $\delta\left(\hat{\boldsymbol{\Sigma}}, \hat{\mathbf{V}}_{r}\right)$ for GEES, respectively. The variability of $\delta$ can be observed in $\delta_{0} = \delta\left(\hat{\mathbf{V}}_{r}, \boldsymbol{\Sigma}\right)$, as $\hat{\mathbf{V}}_{r}$ tends to be highly variable while it provides an unbias estimate of $\boldsymbol{\Sigma}$. On the other hand, the bias of $\delta$ can be observed in $\delta_{0} = \delta\left(\hat{\boldsymbol{\Sigma}}, \boldsymbol{\Sigma}\right)$, as the model-based covariance matrix $\hat{\boldsymbol{\Sigma}}$ could provide a bias estimate of $\boldsymbol{\Sigma}$ based on misspecification of the working correlation structure.

# Simulation setup

## Data
```{r, include = FALSE}
nsims <- 1000L
beta <- c(2.0, 3.0, 0.5, 0, 0, 0)
w <- which(beta != 0)
l <- length(w)
N <- c(rep(200, 7), 300, 240, 150, 120, 100, 80, 75)
n <- c(4, 5, 6, 7, 8, 9, 10, 4, 5, 8, 10, 12, 15, 16)
names_work_corstr <- c(
  "independence",
  "exchangeable",
  "ar1",
  "ar3",
  "unstructured"
)
mv <- c(1, 1, 1, 3, 1)
legend_work_corstr <- paste0(
  toupper(substr(names_work_corstr, 1, 1)),
  substr(names_work_corstr, 2, nchar(names_work_corstr))
)
legend_work_corstr <- ifelse(
  test = legend_work_corstr == "Ar1",
  yes = "AR(1)",
  no = legend_work_corstr
)
legend_work_corstr <- ifelse(
  test = legend_work_corstr == "Ar3",
  yes = "AR(3)",
  no = legend_work_corstr
)
```
Following Wang *et al.* (2012) with one-thousand replications, the correlated normal responses are generated from the model $$y_{ij} = \mathbf{X}_{ij}^{\top}\boldsymbol{\beta} + \varepsilon_{ij},$$ where $i = 1, \ldots, N,$ $j = 1, \ldots, n,$ $\mathbf{X}_{ij} = (x_{ij, 1}, \ldots, x_{ij, 6})^{\top},$ and $\boldsymbol{\beta} = (2.0, 3.0, 0.5, 0, 0, 0)^{\top}$, where the combinations of $N$ and $n$ are listed below.

```{r, echo = FALSE}
all_combos <- data.frame(N = N, n = n)
tab <- knitr::kable(
  x = all_combos,
  format = "html",
  col.names = c("$N$", "$n$")
)
kableExtra::kable_styling(
  kable_input = tab,
  full_width = FALSE
)
```

- For the covariates,
    - $x_{ij,1}$ was generated from the Bernoulli(0.5) distribution, and 
    - each $x_{ij,k}$ for $k = 2 \ldots 6$ was generated from the multivariate normal distribution with mean 0 and an AR(1) covariance matrix with marginal variance 1 and auto-correlation coefficient 0.5.
- The random errors $(\varepsilon_{i1}, \ldots, \varepsilon_{i4})^{\top}$ are generated from the multivariate normal distribution with marginal mean 0, marginal variance 1, and either an **exchangeable** or **AR(1)** correlation structure with a correlation parameter of $\alpha = 0.7$.

## Fitting procedure
Considering the focus of these simulations are on the correlation structure selection, each model, based on data generated by an **exchangeable** or **AR(1)** correlation structure, was fitted using generalized estimating equations. The mean structure was properly specified as $\mathbf{X}_{1}$, $\mathbf{X}_{2}$, and $\mathbf{X}_{3}$ with an intercept that was estimated to be approximately 0. To assess the correlation structure selection properties, the working correlation structure was specified as:

- independence,
- exchangeable,
- AR(1),
- AR(3), and
- unstructured.

## Model selection process
In these simulations, there are four sets of comparisons being made between the four correlation structures. These comparisons are:

1. exchangeable versus AR(1),
2. exchangeable versus AR(1) versus independence,
3. exchangeable versus AR(1) versus independence versus AR(3), and
4. exchangeable versus AR(1) versus independence versus AR(3) versus unstructured.

We are making these comparisons because previous research usually only focuses on exchangeable and AR(1). As these simulations are meant to investigate the selection properties of $\delta_{0}$, for each comparison, the correlation structure that resulted in the minimum $\delta_{0}$ value was selected as the best performing correlation structure.

# Presentation of results

## Import results
The simulation results can be found at:
```{r, echo = TRUE}
res <- readRDS(
  file = paste0(
    "./outputs/corstr/norm-delta0-sim/",
    "norm-delta0-rho70-sim/norm_delta0_rho70_sim.rds"
  )
)
```

```{r, include = FALSE}
# indices for all N and n values
fixed_n <- 1:7
fixed_obs <- c(8:9, 3, 10:14)
```

```{r, include = FALSE}
# creating a function to plot histograms
plot_all <- function(data, index, min_val) {
  # Subsetting the results to only include the results of focus based on index
  res_plot <- data
  res_plot$group <- paste0("N = ", res_plot$N, ", n = ", res_plot$n)
  group_id <- paste0("N = ", N[index], ", n = ", n[index])
  res_plot <- subset(x = res_plot, subset = res_plot$group %in% group_id)
  res_plot$group <- factor(
    x = res_plot$group,
    levels = group_id,
    ordered = TRUE
  )

  # plotting delta values

  ## Independence
  independence_plot <- ggplot2::ggplot(
    data = res_plot,
    mapping = ggplot2::aes(x = independence, fill = group)
  ) +
    ggplot2::geom_density(alpha = 0.5, color = NA) +
    ggplot2::geom_vline(
      xintercept = min_val, linetype = "dotted", color = "firebrick",
      linewidth = 1
    ) +
    ggplot2::labs(
      x = expression(delta[0]),
      y = "Density",
      title = "Working correlation: Independence"
    ) +
    ggplot2::guides(fill = ggplot2::guide_legend(title = "N =, n =")) +
    ggplot2::theme_bw() +
    ggplot2::theme(plot.title = ggplot2::element_text(hjust = 0.5, size = 10))

  ## Exchangeable
  exchangeable_plot <- ggplot2::ggplot(
    data = res_plot,
    mapping = ggplot2::aes(x = exchangeable, fill = group)
  ) +
    ggplot2::geom_density(alpha = 0.5, color = NA) +
    ggplot2::geom_vline(
      xintercept = min_val, linetype = "dotted", color = "firebrick",
      linewidth = 1
    ) +
    ggplot2::labs(
      x = expression(delta[0]),
      y = "Density",
      title = "Working correlation: Exchangeable"
    ) +
    ggplot2::guides(fill = ggplot2::guide_legend(title = "N =, n =")) +
    ggplot2::theme_bw() +
    ggplot2::theme(plot.title = ggplot2::element_text(hjust = 0.5, size = 10))

  ## AR(1)
  ar1_plot <- ggplot2::ggplot(
    data = res_plot,
    mapping = ggplot2::aes(x = ar1, fill = group)
  ) +
    ggplot2::geom_density(alpha = 0.5, color = NA) +
    ggplot2::geom_vline(
      xintercept = min_val, linetype = "dotted", color = "firebrick",
      linewidth = 1
    ) +
    ggplot2::labs(
      x = expression(delta[0]),
      y = "Density",
      title = "Working correlation: AR(1)"
    ) +
    ggplot2::guides(fill = ggplot2::guide_legend(title = "N =, n =")) +
    ggplot2::theme_bw() +
    ggplot2::theme(plot.title = ggplot2::element_text(hjust = 0.5, size = 10))

  ## AR(3)
  ar3_plot <- ggplot2::ggplot(
    data = res_plot,
    mapping = ggplot2::aes(x = ar3, fill = group)
  ) +
    ggplot2::geom_density(alpha = 0.5, color = NA) +
    ggplot2::geom_vline(
      xintercept = min_val, linetype = "dotted", color = "firebrick",
      linewidth = 1
    ) +
    ggplot2::labs(
      x = expression(delta[0]),
      y = "Density",
      title = "Working correlation: AR(3)"
    ) +
    ggplot2::guides(fill = ggplot2::guide_legend(title = "N =, n =")) +
    ggplot2::theme_bw() +
    ggplot2::theme(plot.title = ggplot2::element_text(hjust = 0.5, size = 10))

  ## Unstructured
  unstructured_plot <- ggplot2::ggplot(
    data = res_plot,
    mapping = ggplot2::aes(x = unstructured, fill = group)
  ) +
    ggplot2::geom_density(alpha = 0.5, color = NA) +
    ggplot2::geom_vline(
      xintercept = min_val, linetype = "dotted", color = "firebrick",
      linewidth = 1
    ) +
    ggplot2::labs(
      x = expression(delta[0]),
      y = "Density",
      title = "Working correlation: Unstructured"
    ) +
    ggplot2::guides(fill = ggplot2::guide_legend(title = "N =, n =")) +
    ggplot2::theme_bw() +
    ggplot2::theme(plot.title = ggplot2::element_text(hjust = 0.5, size = 10))
  if (mean(res_plot$unstructured) > (l * 10)) {
    unstructured_plot <- unstructured_plot + ggplot2::xlim(l + 1, 10 * (l + 1))
  }
  ggpubr::ggarrange(
    independence_plot, exchangeable_plot, ar1_plot, ar3_plot,
    unstructured_plot,
    ncol = 2, nrow = 3, common.legend = TRUE, legend = "right"
  )
}
```

```{r, include = FALSE}
# creating functions to calculate statistics

## mean
mean_all <- function(data, index) {
  # Subsetting the results to only include the results of focus based on index
  res_plot <- data
  res_plot$group <- paste0("N = ", res_plot$N, ", n = ", res_plot$n)
  group_id <- paste0("N = ", N[index], ", n = ", n[index])
  res_plot <- subset(x = res_plot, subset = res_plot$group %in% group_id)
  res_plot$group <- factor(
    x = res_plot$group,
    levels = group_id,
    ordered = TRUE
  )
  # Creating table
  mean_tab <- dplyr::group_by(.data = res_plot, group)
  mean_tab <- dplyr::summarise(
    .data = mean_tab,
    independence = mean(independence),
    exchangeable = mean(exchangeable),
    ar1 = mean(ar1),
    ar3 = mean(ar3),
    unstructured = mean(unstructured)
  )
  mean_tab <- knitr::kable(
    x = mean_tab, format = "html", digits = 3,
    col.names = c("N =, n =", legend_work_corstr),
    caption = "Mean of values"
  )
  kableExtra::kable_styling(kable_input = mean_tab, full_width = FALSE)
}

## variance
variance_all <- function(data, index) {
  # Subsetting the results to only include the results of focus based on index
  res_plot <- data
  res_plot$group <- paste0("N = ", res_plot$N, ", n = ", res_plot$n)
  group_id <- paste0("N = ", N[index], ", n = ", n[index])
  res_plot <- subset(x = res_plot, subset = res_plot$group %in% group_id)
  res_plot$group <- factor(
    x = res_plot$group,
    levels = group_id,
    ordered = TRUE
  )
  # Creating table
  var_tab <- dplyr::group_by(.data = res_plot, group)
  var_tab <- dplyr::summarise(
    .data = var_tab,
    independence = stats::var(independence),
    exchangeable = stats::var(exchangeable),
    ar1 = stats::var(ar1),
    ar3 = stats::var(ar3),
    unstructured = stats::var(unstructured)
  )
  var_tab <- knitr::kable(
    x = var_tab, format = "html", digits = 3,
    col.names = c("N =, n =", legend_work_corstr),
    caption = "Variance of values"
  )
  kableExtra::kable_styling(kable_input = var_tab, full_width = FALSE)
}
```

and are dependent on the data generation mechanism (`corstr`) and the covariance estimator (`type`) used to caclulate the $\delta_{0}$.

## Distribution of $\delta_{0}$ {.tabset .tabset-fade}
The first set of results being presented are the values of $\delta_{0}$ for each working correlation structure across the one-thousand replications given the data generation mechanism and the covariance estimate used. The results are presented based on the data simulation process (i.e., *Fixed N* or *Fixed total number of observations*). The oracle $\delta$ values are obtained by estimating $cov\left(\hat{\boldsymbol{\beta}}\right)$ through 10,000 simulations.

### Generating correlation structure: Exchangeable {.tabset .tabset-fade .tabset-pills}
The distributions of the $\delta_{0}$ presented below are based on the data generation process that used an *exchangeable* correlation structure.

#### Covariance estimator: Model-based
These distributions of $\delta_{0}$ are based on

$$
\delta_{0} = \delta\left(\hat{\boldsymbol{\Sigma}}, \boldsymbol{\Sigma}\right).
$$
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include generating correlation structure
# and covariance estimator of interest
res_delta <- subset(
  x = res,
  subset = corstr == "exchangeable" & type == "mb"
)
```

##### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# plotting delta values
plot_all(data = res_delta, index = fixed_n, min_val = l + 1)

# table summarizing delta values
## Mean
mean_all(data = res_delta, index = fixed_n)

## Variance
variance_all(data = res_delta, index = fixed_n)
```


##### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# plotting delta values
plot_all(data = res_delta, index = fixed_obs, min_val = l + 1)

# table summarizing delta values
## Mean
mean_all(data = res_delta, index = fixed_obs)

## Variance
variance_all(data = res_delta, index = fixed_obs)
```

#### Covariance estimator: Robust
These distributions of $\delta_{0}$ are based on

$$
\delta_{0} = \delta\left(\hat{\mathbf{V}}_{r}, \boldsymbol{\Sigma}\right).
$$
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include generating correlation structure
# and covariance estimator of interest
res_delta <- subset(
  x = res,
  subset = corstr == "exchangeable" & type == "vr"
)
```

##### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# plotting delta values
plot_all(data = res_delta, index = fixed_n, min_val = l + 1)

# table summarizing delta values
## Mean
mean_all(data = res_delta, index = fixed_n)

## Variance
variance_all(data = res_delta, index = fixed_n)
```


##### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# plotting delta values
plot_all(data = res_delta, index = fixed_obs, min_val = l + 1)

# table summarizing delta values
## Mean
mean_all(data = res_delta, index = fixed_obs)

## Variance
variance_all(data = res_delta, index = fixed_obs)
```

### Generating correlation structure: AR(1) {.tabset .tabset-fade .tabset-pills}
The distributions of the $\delta_{0}$ presented below are based on the data generation process that used an *AR(1)* correlation structure.

#### Covariance estimator: Model-based
These distributions of $\delta_{0}$ are based on

$$
\delta_{0} = \delta\left(\hat{\boldsymbol{\Sigma}}, \boldsymbol{\Sigma}\right).
$$
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include generating correlation structure
# and covariance estimator of interest
res_delta <- subset(
  x = res,
  subset = corstr == "ar1" & type == "mb"
)
```

##### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# plotting delta values
plot_all(data = res_delta, index = fixed_n, min_val = l + 1)

# table summarizing delta values
## Mean
mean_all(data = res_delta, index = fixed_n)

## Variance
variance_all(data = res_delta, index = fixed_n)
```


##### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# plotting delta values
plot_all(data = res_delta, index = fixed_obs, min_val = l + 1)

# table summarizing delta values
## Mean
mean_all(data = res_delta, index = fixed_obs)

## Variance
variance_all(data = res_delta, index = fixed_obs)
```

#### Covariance estimator: Robust
These distributions of $\delta_{0}$ are based on

$$
\delta_{0} = \delta\left(\hat{\mathbf{V}}_{r}, \boldsymbol{\Sigma}\right).
$$
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include generating correlation structure
# and covariance estimator of interest
res_delta <- subset(
  x = res,
  subset = corstr == "ar1" & type == "vr"
)
```

##### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# plotting delta values
plot_all(data = res_delta, index = fixed_n, min_val = l + 1)

# table summarizing delta values
## Mean
mean_all(data = res_delta, index = fixed_n)

## Variance
variance_all(data = res_delta, index = fixed_n)
```


##### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# plotting delta values
plot_all(data = res_delta, index = fixed_obs, min_val = l + 1)

# table summarizing delta values
## Mean
mean_all(data = res_delta, index = fixed_obs)

## Variance
variance_all(data = res_delta, index = fixed_obs)
```

## Correlation structure selection {.tabset .tabset-fade}
Now we will examine the selection properties of $\delta_{0}$ given the generating correlation structure, covariance estimator, and working correlation structures being compared. The comparisons are:

1. exchangeable versus AR(1),
2. exchangeable versus AR(1) versus independence, and
3. exchangeable versus AR(1) versus independence versus AR(3), and
4. exchangeable versus AR(1) versus independence versus AR(3) versus unstructured.

and the results are presented based on the defined numbering system of these comparisons. For each comparison, the hope is the working correlation structure selected by the minimum $\delta_{0}$ value is the generating correlation structure the majority of the time.
```{r, echo = FALSE}
corstr_count <- function(x) {
  count_indp <- 0
  count_cs <- 0
  count_ar1 <- 0
  count_ar3 <- 0
  count_un <- 0
  for (i in seq_along(x)) {
    count_indp <- count_indp + (x[i] == "independence")
    count_cs <- count_cs + (x[i] == "exchangeable")
    count_ar1 <- count_ar1 + (x[i] == "ar1")
    count_ar3 <- count_ar3 + (x[i] == "ar3")
    count_un <- count_un + (x[i] == "unstructured")
  }
  temp <- data.frame(
    independence = count_indp, exchangeable = count_cs,
    ar1 = count_ar1, ar3 = count_ar3, un = count_un
  )
  return(temp)
}
```

### Generating correlation structure: Exchangeable {.tabset .tabset-fade .tabset-pills}
The selection properties of the $\delta_{0}$ presented below are based on the data generation process that used an *exchangeable* correlation structure.

#### Covariance estimator: Model-based {.tabset .tabset-fade}
These selection properties of $\delta_{0}$ are based on

$$
\delta_{0} = \delta\left(\hat{\boldsymbol{\Sigma}}, \boldsymbol{\Sigma}\right).
$$
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include generating correlation structure
# and covariance estimator of interest
res_delta <- subset(
  x = res,
  subset = corstr == "exchangeable" & type == "mb"
)
```

##### Comparison 1

For structure selection comparison 1, we are only considering the working correlation structures of *exchangeable* and *AR(1)*.

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel1)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel1)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

##### Comparison 2

For structure selection comparison 2, we are only considering the working correlation structures of *independence*, *exchangeable*, and *AR(1)*.

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel2)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel2)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

##### Comparison 3

For structure selection comparison 1, we are considering all the working correlation structures of *independence*, *exchangeable*, *AR(1)*, and *AR(3)*.

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel3)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel3)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

##### Comparison 4

For structure selection comparison 1, we are considering all the working correlation structures of *independence*, *exchangeable*, *AR(1)*, *AR(3)*, and "unstructured".

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel4)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel4)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

#### Covariance estimator: Robust {.tabset .tabset-fade}
These distributions of $\delta_{0}$ are based on

$$
\delta_{0} = \delta\left(\hat{\mathbf{V}}_{r}, \boldsymbol{\Sigma}\right).
$$
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include generating correlation structure
# and covariance estimator of interest
res_delta <- subset(
  x = res,
  subset = corstr == "exchangeable" & type == "vr"
)
```

##### Comparison 1

For structure selection comparison 1, we are only considering the working correlation structures of *exchangeable* and *AR(1)*.

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel1)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel1)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

##### Comparison 2

For structure selection comparison 2, we are only considering the working correlation structures of *independence*, *exchangeable*, and *AR(1)*.

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel2)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel2)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

##### Comparison 3

For structure selection comparison 1, we are considering all the working correlation structures of *independence*, *exchangeable*, *AR(1)*, and *AR(3)*.

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel3)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel3)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

##### Comparison 4

For structure selection comparison 1, we are considering all the working correlation structures of *independence*, *exchangeable*, *AR(1)*, *AR(3)*, and "unstructured".

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel4)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel4)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

### Generating correlation structure: AR(1) {.tabset .tabset-fade .tabset-pills}
The selection properties of the $\delta_{0}$ presented below are based on the data generation process that used an *AR(1)* correlation structure.

#### Covariance estimator: Model-based {.tabset .tabset-fade}
These selection properties of $\delta_{0}$ are based on

$$
\delta_{0} = \delta\left(\hat{\boldsymbol{\Sigma}}, \boldsymbol{\Sigma}\right).
$$
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include generating correlation structure
# and covariance estimator of interest
res_delta <- subset(
  x = res,
  subset = corstr == "ar1" & type == "mb"
)
```

##### Comparison 1

For structure selection comparison 1, we are only considering the working correlation structures of *exchangeable* and *AR(1)*.

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel1)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel1)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

##### Comparison 2

For structure selection comparison 2, we are only considering the working correlation structures of *independence*, *exchangeable*, and *AR(1)*.

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel2)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel2)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

##### Comparison 3

For structure selection comparison 1, we are considering all the working correlation structures of *independence*, *exchangeable*, *AR(1)*, and *AR(3)*.

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel3)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel3)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

##### Comparison 4

For structure selection comparison 1, we are considering all the working correlation structures of *independence*, *exchangeable*, *AR(1)*, *AR(3)*, and "unstructured".

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel4)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel4)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

#### Covariance estimator: Robust {.tabset .tabset-fade}
These distributions of $\delta_{0}$ are based on

$$
\delta_{0} = \delta\left(\hat{\mathbf{V}}_{r}, \boldsymbol{\Sigma}\right).
$$
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include generating correlation structure
# and covariance estimator of interest
res_delta <- subset(
  x = res,
  subset = corstr == "ar1" & type == "vr"
)
```

##### Comparison 1

For structure selection comparison 1, we are only considering the working correlation structures of *exchangeable* and *AR(1)*.

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel1)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel1)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

##### Comparison 2

For structure selection comparison 2, we are only considering the working correlation structures of *independence*, *exchangeable*, and *AR(1)*.

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel2)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel2)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

##### Comparison 3

For Comparison 1, we are considering all the working correlation structures of *independence*, *exchangeable*, *AR(1)*, and *AR(3)*.

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel3)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel3)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```

##### Comparison 4

For structure selection comparison 1, we are considering all the working correlation structures of *independence*, *exchangeable*, *AR(1)*, *AR(3)*, and "unstructured".

###### Fixed N
In these results, the number of subjects does **NOT** change and stays fixed at `r N[1]`. However, the number of observations for each subject has increases from `r n[fixed_n[1]]` to `r n[fixed_n[length(fixed_n)]]` by 1. Thus, the overall number observations is also increasing.
```{r, echo = FALSE, fig.align = "center", out.width = "100%"}
# Subsetting the results to only include the results focused on fixed N
# simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_n], ", n = ", n[fixed_n])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel4)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = 200, n =", legend_work_corstr),
  caption = "Selection properties for Fixed N"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```


###### Fixed total number of observations
In these results, the total number of observations does **NOT** change and stays fixed at `r N[fixed_obs[1]] * n[fixed_obs[1]]`. However, the number of subjects and the number of observations for each subject changes. The numbers of subjects are N: `r N[fixed_obs]` while the number of observations for each subjects are n: `r n[fixed_obs]`.
```{r, echo = FALSE, fig.align = "center", out.width = "100%", warning = FALSE}
# Subsetting the results to only include the results focused on fixed total
# number of observations simulations
res_sel <- res_delta
res_sel$group <- paste0("N = ", res_sel$N, ", n = ", res_sel$n)
group_id <- paste0("N = ", N[fixed_obs], ", n = ", n[fixed_obs])
res_sel <- subset(x = res_sel, subset = group %in% group_id)
res_sel$group <- factor(x = res_sel$group, levels = group_id, ordered = TRUE)
res_sel <- res_sel[order(res_sel$group), ]
res_sel <- split(x = res_sel, f = res_sel$group)
sel <- lapply(
  X = res_sel,
  FUN = function(x) {
    data.frame(
      n = unique(x$group),
      corstr_count(x$sel4)
    )
  }
)
sel <- dplyr::bind_rows(sel)
sel_tab <- knitr::kable(
  x = sel, format = "html",
  col.names = c("N = , n =", legend_work_corstr),
  caption = "Selection properties for Fixed total number of observations"
)
kableExtra::kable_styling(kable_input = sel_tab, full_width = FALSE)
```